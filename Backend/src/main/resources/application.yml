# Configurazione base portfolio backend

spring:
  application:
    name: portfolio-backend

  # DataSource: SQLite. URL da variabile DB_URL o default (relativo alla working dir, es. Backend).
  datasource:
    url: ${DB_URL:jdbc:sqlite:../Database/portfolio.db}
    driver-class-name: org.sqlite.JDBC

  # JPA/Hibernate: ddl-auto crea/aggiorna le tabelle dalle entity (es. password_reset_tokens).
  # update = crea tabelle mancanti e nuove colonne, non elimina dati (ok per dev/small prod).
  # In produzione con migrazioni (Flyway/Liquibase) usa: validate o none.
  jpa:
    hibernate:
      ddl-auto: update

# ---------------------------------------------------------------------------
# CORS (origini consentite per richieste browser cross-origin)
# ---------------------------------------------------------------------------
# In SecurityConfig: se CORS_ALLOWED_ORIGINS è impostata in .env, viene usata;
# altrimenti le origini sono costruite da FRONTEND_URL + ADMIN_FRONTEND_URL (.env).
# Nessun URL hardcoded nel codice.
app:
  cors: {}

  # ---------------------------------------------------------------------------
  # Data retention (cancellazione automatica dati vecchi)
  # ---------------------------------------------------------------------------
  data-retention:
    retention-days: 90
    cron: "0 0 2 * * ?"
    batch-size: 500

  # ---------------------------------------------------------------------------
  # Password Reset (reset password via email)
  # ---------------------------------------------------------------------------
  password-reset:
    # Durata validità token di reset in minuti (default: 60 = 1 ora)
    token-expiration-minutes: 60
    # Cron per pulizia token scaduti (ogni giorno alle 3:00 AM)
    cleanup-cron: "0 0 3 * * ?"
    # URL dell'app admin per il link nella mail (deve essere la base dell'admin, es. https://admin.tuodomain.com o http://localhost:5173)
    frontend-url: ${ADMIN_FRONTEND_URL:}
    # Abilita invio email (false = solo log, true = invia email via SMTP)
    email-enabled: ${PASSWORD_RESET_EMAIL_ENABLED:true}
